{% extends "AppBundle:Amministratore:Abase.html.twig" %}

{% block title %}Nuova Producibile{% endblock %}

{% block javascripts %}
    {{parent()}}

    <script src="{{ asset("Amministratore/dist/jstree.min.js") }}"></script>
    <script src="{{ asset("Amministratore/js/salvaProducibile.js") }}"></script>
     <script src="{{ asset("Amministratore/js/AlberoCategorieCheck.js") }}"></script>
{% endblock %}

{% block corpo %}

<div id="content" class="top">
	<h4>Nuovo Producibile</h4>
    <table>
        <form method="post" action="" >
            <tbody>
                <tr valign="top">
                    <td>
                        <div class="field-box" id='divNome'>
                            <label>Nome :</label>
                            <input name="nome" id="nome" value="{{producibile.nome}}" placeholder="" class="span6" style="width:240px" type="text">
                        </div>
                        <div class="field-box" id='divDescrizione'>
                            <label>Breve descrizione:</label>
                            <input name="descrizione" id="descrizione" value="{{producibile.descrizione}}" class="span6" style="width:240px" type="text">
                        </div>
                         <div class="field-box" id="divCompenso">
                            <label>Inserisci Compenso Grafico:</label>
                            <input name="compenso" type="number" step="0.01" id="compenso" value="{{producibile.compensoGrafico}}" class="span6" style="width:240px" type="text">
                        </div>
                        <div class="field-box" id="divImmagine">
                            <label>Inserisci immaggine:</label>
                            <input name="immagine" type="file" id="immagine" value="{{producibile.immagine}}" class="span6" style="width:240px" type="text">
                        </div> 
                    </td>
                </tr>
                <tr>
                    <td id="divAlbero">
                        <label>Seleziona Categorie:</label>
                        <div id="tree-container">
                            <!-- L'abero verrÃ  caricato qui, non inserire codice in questo div -->
                        </div>
                        <div id="divCategorie"></div>
                    </td>
                </tr>
            </tbody>
            <a id="invia" type="submit" class="btn-flat primary" onclick=modifica({{categoria.id}});>Invia</a>
        </form>	
    </table>
</section>
    <script>
        var categorieAlbero;
        $("#tree-container").on("select_node.jstree",function(evt, data){
            $("#invia").show();
            console.log("top:");  
            console.log($("#tree-container").jstree('get_top_checked'));
            console.log("bottom");
            console.log($("#tree-container").jstree('get_bottom_checked'));
            categorie=$("#tree-container").jstree('get_bottom_checked');
            temp="Categorie selezionate:  ";
            categorieAlbero=categorie;
            for(i=0 ; i < categorie.length ; i++){
                node = $('#tree-container').jstree(true).get_node(categorie[i]);
                temp=temp+"      "+node.text;
                categorieAlbero=categorieAlbero.concat(node.parents)
                
                }
            console.log(categorieAlbero);
            temp=temp + "</br> appartiene, inoltre a tutte le categorie superiori a quelle selezionate."
            $("#divCategorie").html(temp);
    }
      
);
    </script>
</div>
{% endblock %}

